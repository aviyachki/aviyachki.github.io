<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.110.0">
    <meta name="description" content="Open Detection Engineering Framework Wiki Page">
<meta name="author" content="Atanas Viyachki">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Sunrise - ODEF</title>

    
    <link href="/css/nucleus.css?1681063769" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1681063769" rel="stylesheet">
    <link href="/css/hybrid.css?1681063769" rel="stylesheet">
    <link href="/css/featherlight.min.css?1681063769" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1681063769" rel="stylesheet">
    <link href="/css/auto-complete.css?1681063769" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1681063769" rel="stylesheet">
    <link href="/css/theme.css?1681063769" rel="stylesheet">
    <link href="/css/tabs.css?1681063769" rel="stylesheet">
    <link href="/css/hugo-theme.css?1681063769" rel="stylesheet">
    
    <link href="/css/theme-purple.css?1681063769" rel="stylesheet">
    
    <link href="/css/foo.css?1681063769" rel="stylesheet"><link href="/css/bar.css?1681063769" rel="stylesheet">

    <script src="/js/jquery-3.3.1.min.js?1681063769"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/odef/phases/sunrise/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      
<a id="logo" href='/'>
   <img src="/images/odef-logo.png">
 </a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1681063769"></script>
<script type="text/javascript" src="/js/auto-complete.js?1681063769"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/www.odef.wiki\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1681063769"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/odef/" title="The Framework" class="dd-item
        parent
        
        
        ">
      <a href="/odef/">
          <b>1. </b>The Framework
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/odef/introduction/" title="Introduction" class="dd-item ">
        <a href="/odef/introduction/">
        Introduction
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odef/framework-core/" title="Framework Core" class="dd-item ">
        <a href="/odef/framework-core/">
        Framework Core
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/odef/phases/" title="Phases" class="dd-item
        parent
        
        
        ">
      <a href="/odef/phases/">
          Phases
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/odef/phases/sunrise/" title="Sunrise" class="dd-item active">
        <a href="/odef/phases/sunrise/">
        Sunrise
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odef/phases/midday/" title="Midday" class="dd-item ">
        <a href="/odef/phases/midday/">
        Midday
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/odef/phases/sunset/" title="Sunset" class="dd-item ">
        <a href="/odef/phases/sunset/">
        Sunset
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/demm/" title="DEMM" class="dd-item
        
        
        
        ">
      <a href="/demm/">
          <b>2. </b>DEMM
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/demm/intro/" title="Maturity Model" class="dd-item ">
        <a href="/demm/intro/">
        Maturity Model
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/demm/operational-maturity/" title="Operational Maturity" class="dd-item ">
        <a href="/demm/operational-maturity/">
        Operational Maturity
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/dac/" title="DAC" class="dd-item
        
        
        
        ">
      <a href="/dac/">
          <b>3. </b>DAC
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/dac/odef-templates/" title="Templates" class="dd-item ">
        <a href="/dac/odef-templates/">
        Templates
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dac/yml-file/" title="The yaml file" class="dd-item ">
        <a href="/dac/yml-file/">
        The yaml file
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/knowledge/" title="Knowledge management" class="dd-item
        
        
        
        ">
      <a href="/knowledge/">
          <b>4. </b>Knowledge management
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/knowledge/doc-template/" title="Documentation Template" class="dd-item ">
        <a href="/knowledge/doc-template/">
        Documentation Template
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      

      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Home</a> > <a href='/odef/'>The Framework</a> > <a href='/odef/phases/'>Phases</a> > Sunrise
          
        
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#phase-1-sunrise-">Phase 1Ô∏è‚É£ Sunrise üåÖ</a>
      <ul>
        <li></li>
        <li><a href="#process-flow">Process Flow</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Sunrise
            </h1>
          

        


<h2 id="phase-1-sunrise-">Phase 1Ô∏è‚É£ Sunrise üåÖ</h2>
<p>Sunrise is the first phase of the detection lifecycle. It marks the inception, development and deployment of the detection. During that phase there are 6 core functions that should be addressed:</p>
<ul>
<li>Research</li>
<li>Prepare (Logging)</li>
<li>Build (Detection Content)</li>
<li>Validate</li>
<li>Automate</li>
<li>Share (Knowledge)</li>
</ul>
<h4 id="high-level-goals-for-the-sunrise-phase">High level goals for the Sunrise phase</h4>
<ul>
<li>Build high fidelity detection</li>
<li>Ensure detection validation</li>
<li>Create documentation</li>
<li>Integrate and automate in the environment</li>
<li>Socialize the detection with the security organization</li>
</ul>
<table >
<thead>
  <tr>
    <th>Functions</th>
    <th >Goal</th>
    <th >Description</th>
    <th >Guidelines</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td rowspan="5"><b>Research</b></td>
    <td> Opportunity Identification</td>
    <td> It can be triggered from analyzing threat intelligence reports, or OSINT, or internal knowledge for a particular security gap. Document the use case and the goals of the detection as part of the opportunity identification process. </td>
    <td>  
<ul>
<li>Document the use case that you‚Äôre building and set goals.</li>
<li>Is the TTP already covered by an existing alert or detection?</li>
<li>Is there sufficient knowledge to start building or additional research would be required?</li>
<li>What are sources of information that will assist the research?</li>
</ul>
</td>
  </tr>
  <tr>
    <td>  <b>Prioritize</b></td>
    <td>  Detection engineering work has to be prioritized and tracked. Work prioritization can be based on urgency and priority. Backlog of detections and security posture activities is desirable and recommended.
</td>
    <td>  Prioritization criteria:
<ul>
<li>
<p>Criticality of the system</p>
</li>
<li>
<p>Highest level of threat to the organization</p>
</li>
<li>
<p>Ease of Exploitation</p>
</li>
<li>
<p>Past incidents</td></p>
</tr>
<tr>
  <td>  Develop Research Questions</td>
  <td>  Write your research questions that while answering you will gain understanding of the topic. </td>
  <td>  Examples:
<ul>
<li>Write down what you already know or don&rsquo;t know about the topic.</li>
<li>Use that information to develop questions. Use probing questions. (why? what if?).</li>
<li>Avoid &ldquo;yes&rdquo; and &ldquo;no&rdquo; questions </td></li>
</ul>
</tr>
<tr>
  <td>  Information Gathering</td>
  <td>  Research and collect sufficient information in order to start understanding the detection</td>
  <td>  Provides a good overview of the topic if you are unfamiliar with it.
<ul>
<li>Identify important facts, dates, events, history, organizations, etc. (in case the detection is a response to a past incident.)</li>
<li>Find bibliographies which provide additional sources of information (include in the Appendix section detection document)</li>
</ul>
</li>
</ul>
</td>
  </tr>
  <tr>
    <td>  Technical Context</td>
    <td>  Create and understand technical context around the detection</td>
    <td>  
      <ul>
        <li> Start putting technical writeup by summarizing the most important information from technical aspect </li>
        <li> Research the technology associated with the technique to help understand the use cases, related data sources, and detection opportunities </li>
        <li> Note: Defenders often create superficial detections because they lack an understanding of the technology involved. In case of uncertainties it is best to engage the team or engineer responsible for the management of the technology</li>
      </ul>
</td>
  </tr>
  <tr>
    <td> <b>Prepare</b><br></td>
    <td> Identify Dataset</span></td>
    <td> Identify the log source that will be used for the detection</td>
    <td>  <b>Know your environment</b>
      <ul>
        <li> Understand the data source and document it by creating a data dictionary.</li>
        <li> The data dictionary should grow and contain sources of data and their corresponding schemas. It can later be used to quickly refer to. </li>
      </ul>
</td>
  </tr>
  <tr>
    <td><b>Visibility Check</b></span></td>
    <td>  Ensure there is sufficient logging, retention and visibility in order to successfully build the detection and satisfy the use case</td>
    <td>  
      <ul>
        <li> Use the accumulated technical knowledge to identify source and identify the events required to build detection</li>
        <li> Use any historical events in order to validate that there is sufficient visibility </li>
      </ul>
</td>
  </tr>
  <tr>
    <td><b>Improve(optional)</b></span></td>
    <td>  Once the data is explored we can identify opportunities for improvements such as:
      <ul>
        <li>Collecting additional logs or change logging levels </li>
        <li>Create additional attributes (parsing of raw logs)</li>
        <li>Consolidation of distinct logs</li>
      </ul>
</td>
    <td>  Improvement initiatives and requests should be communicated to the responsible for the dataset in question team. For that purpose it makes sense to maintain a contact list that provides quick reference to technology, support/engineering teams and contact details.
</td>
  </tr>
  <tr>
    <td><b>Build &amp; Enrich</b></td>
    <td>  Detection Creation</span></td>
    <td>  Create a detection query against the identified dataset</td>
    <td>  Having a good understanding of the technical context and the data source begin building queries to narrow down the data to actionable insight.</td>
  </tr>
  <tr>
    <td><b>Manual Testing</b></span></td>
    <td>  Perform a manual testing and ensure the query works syntax and logical perspective</td>
    <td>  
    <ul>
        <li>Ensure the query does not have any syntax errors</li>
        <li>In case the detection is build in response to past incident ensure that the query is indeed catching true positive events</li>
    </ul>
      </td>
  </tr>
  <tr>
    <td><b>Baseline development</b></span></td>
    <td>  Develop a baseline (if needed) that will improve the detection fidelity</td>
    <td>  
        <ul>
          <li>Baselines are sets of known and verified good behaviors and events present in the organization. Those events are normally excluded from the detection logic. </li>
          <li>Baselines decisions and considerations should be documented and clearly states in the ADS</li>
          <li>Baselines are included in the hunt.yml/tf/hcl or alert.yml/tf/hcl files</li>
        </ul>
    </td>
  </tr>
  <tr>
    <td><b>Unittest Development</b></span></td>
    <td>  The unittest development is dependent on the type of devops pipeline. Simple goals are provided.
        </td>
    <td>  Goals for the unittesting:
          <ul>
            <li>Changes or missing data</li>
            <li>Syntax errors </li>
            <li>To confirm detection logic by performing true positive detection</li>
        </ul></td>
  </tr>
  <tr>
    <td>  Enrich</td>
    <td>  Enrich with additional data source if required</td>
    <td>   
          <ul>
          <li>Each hunt could have different enrichment requirements. In some cases HR database could be used in order to understand if a person is on vacation, other trivial cases could be lookup of a hash, ip or domain in an threat intelligence repository etc.</li>
        </ul> </td>
  </tr>
  <tr>
    <td>Document</span></td>
    <td>  
        <ul>
          <li>Create KB Document</li>
          <li>Complete the ADS </li>
          <li> Mitre minefield update</li>
        </ul>
        </td>
    <td>  
    <ul>
          <li>Central knowledge base repository is required in order to mature the detection engineering program. This can be a github repository with controlled access that provides on a need to know basis the security teams members with access.</li>
          <li>Each hunt should have a corresponding <b>README.MD</b> file that provides sufficient information and context. Consider an SOC analyst or Incident Responder responding to an event from your detection. By looking at the documentation they should be easily briefed on the premise and technicalities of the detection. </li>
        </ul></td>
  </tr>
  <tr>
    <td>  Validate</td>
    <td>  Confirm unittests</span></td>
    <td>  Confirm unittest are working </td>
    <td>  Confirmation of the unittests can be done by inspecting the implemented devops pipeline and ensuring that the actions (in the case of github) for unittests are running</td>
  </tr>
  <tr>
    <td>  True Positive validation</td>
    <td>  Validate true positive event against real dataset using the query developed earlier. </td>
    <td>  
    True positive validation can be achieved by:
        <ul>
          <li>Using historical event that exists in the central data repository</li>
          <li>Emulation of the TTP by executing it in a controlled environment </li>
        </ul>
        </td>
  </tr>
  <tr>
    <td>  False Positive Validation</td>
    <td>  Ensure no FP are produced by the query when ran against the prod dataset. </td>
    <td>  
      <ul>
          <li>False positive events are good known events which are produced as output results by the detection/hunt query. </li>
          <li>If baseline is used it should be validated that the baseline is catching those good known events.
          Splunk example:
          Splunk you can use <b>makeresult</b> command to create fake results and test your baseline and how you handle false positives. </li>
      </ul>
    </td>
  </tr>
  <tr>
    <td>  Automate</td>
    <td>  Automation &amp; deployment</span></td>
    <td>  This step is entirely dependant on the environment and should follow the standard ci/cd or automation practices of the organization. </td>
    <td>  Integrate with devops pipeline and enable continuous deployment </td>
  </tr>
  <tr>
    <td>  Share</td>
    <td>  Socialize the new detection</td>
    <td>  A notification process is required and it should be created. The process can be in the form of newsletter or slack channel notification, preferably automated one.</td>
    <td>  Follow a process to communicate the newly created detection with the Security Teams and inform them about it</td>
  </tr>
  <tr>
    <td>  Update Sec Dependency Tree</td>
    <td>  This document is actually part of the repository and can be shared with data engineering and security teams. The goal of sharing it is to promote care mentality where teams would check before they change. Meaning, if data engineer is about to rename an index they should first check if the index is being used. Having dependency document as part of the repository makes it easy and seamless for them to check. </td>
    <td>  Update organization wide document showing dependencies for the detections</td>
  </tr>
</tbody>
</table>
<h3 id="process-flow">Process Flow</h3>

<div class="mermaid" align="left">
graph TD;
Research1(Opportunity Identification) -->Research2(Prioritize);
Research2 -->Research3(Develop Research Questions);
Research3 -->Research4(Information Gathering);
Research4 -->Research5(Collect Technical Context);
Research5 -->Prepare1(Identify Dataset);
Prepare1 -->Prepare2(Visibility Check);
Prepare2 -->Prepare3{Improve};
Prepare3 --> |yes| cis[Start security improvement initiative];
Prepare3 --> |no| Build1(Detection Query Creation);
Build1 --> Build2(Manual Testing);
Build2 --> Build3(Baseline development);
Build3 --> Build4(Automated Unittest Development);
Build4 -->Build5(Enrich);
Build5 --> Build6(Document);
Build6 -->  Validate1(Confirm unittests);
Validate1 -->val2(True/False Positive validation);
val2-->automate(Automation & deployment);
automate --> share(Socialize the new detection);
share -->share1(Update Sec Dependency Tree);
</div>



<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/odef/phases/" title="Phases"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/odef/phases/midday/" title="Midday" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1681063769"></script>
    <script src="/js/perfect-scrollbar.min.js?1681063769"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1681063769"></script>
    <script src="/js/jquery.sticky.js?1681063769"></script>
    <script src="/js/featherlight.min.js?1681063769"></script>
    <script src="/js/highlight.pack.js?1681063769"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1681063769"></script>
    <script src="/js/learn.js?1681063769"></script>
    <script src="/js/hugo-learn.js?1681063769"></script>
    
        
            <script src="https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

